<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poetry Notes Mind Map</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Georgia', serif;
        }

        body {
            background-color: #fefefe;
            color: #333;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        header h1 {
            font-size: 2.5rem;
            color: #4a5568;
            margin-bottom: 5px;
            font-weight: normal;
        }

        header p {
            font-size: 1rem;
            color: #718096;
            font-style: italic;
        }

        .main-layout {
            display: flex;
            gap: 20px;
            height: calc(100vh - 160px);
        }

        .mindmap-area {
            flex: 3;
            background-color: #f9f7f7;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            padding: 15px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .controls-panel {
            flex: 1;
            background-color: white;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            overflow-y: auto;
            max-width: 320px;
        }

        .panel-title {
            font-size: 1.3rem;
            color: #4a5568;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }

        #mindmap {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: auto;
        }

        .node {
            position: absolute;
            background-color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            padding: 12px;
            max-width: 180px;
            z-index: 10;
        }

        .node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
            z-index: 100;
        }

        .node.active {
            border-color: #4299e1;
            box-shadow: 0 4px 8px rgba(66, 153, 225, 0.2);
        }

        .node-title {
            font-weight: bold;
            font-size: 1rem;
            color: #2d3748;
            margin-bottom: 5px;
            word-wrap: break-word;
        }

        .node-meta {
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 8px;
        }

        .node-notes {
            font-size: 0.85rem;
            color: #4a5568;
            line-height: 1.4;
            max-height: 60px;
            overflow: hidden;
            word-wrap: break-word;
        }

        .node-center {
            width: 120px;
            height: 120px;
            background-color: #f7fafc;
            border: 2px dashed #cbd5e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: #4a5568;
            flex-direction: column;
            border-radius: 50%;
        }

        .node-center i {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: #a0aec0;
        }

        .connection {
            position: absolute;
            background-color: #e2e8f0;
            transform-origin: 0 0;
            height: 1px;
            z-index: 1;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-size: 0.9rem;
            color: #4a5568;
            margin-bottom: 5px;
            font-weight: 500;
        }

        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.95rem;
            font-family: 'Georgia', serif;
            resize: vertical;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }

        .btn {
            background-color: #4299e1;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: background-color 0.2s;
            width: 100%;
        }

        .btn:hover {
            background-color: #3182ce;
        }

        .btn-secondary {
            background-color: #e2e8f0;
            color: #4a5568;
            margin-top: 10px;
        }

        .btn-secondary:hover {
            background-color: #cbd5e0;
        }

        .poem-details {
            background-color: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            border: 1px solid #e2e8f0;
        }

        .poem-details h3 {
            font-size: 1.2rem;
            color: #2d3748;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }

        .detail-item {
            margin-bottom: 15px;
        }

        .detail-label {
            font-size: 0.85rem;
            color: #718096;
            margin-bottom: 5px;
        }

        .detail-content {
            font-size: 0.95rem;
            color: #2d3748;
            line-height: 1.5;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #a0aec0;
        }

        .empty-state i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: #a0aec0;
            font-size: 0.85rem;
            border-top: 1px solid #e2e8f0;
        }

        .instructions {
            font-size: 0.85rem;
            color: #718096;
            background-color: #f7fafc;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            border-left: 3px solid #4299e1;
        }

        @media (max-width: 900px) {
            .main-layout {
                flex-direction: column;
                height: auto;
            }
            
            .controls-panel {
                max-width: 100%;
            }
            
            .mindmap-area {
                min-height: 500px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Poetry Notes Mind Map</h1>
            <p>Visual organization for your poems and notes</p>
        </header>

        <div class="main-layout">
            <div class="mindmap-area">
                <div id="mindmap"></div>
            </div>

            <div class="controls-panel">
                <h2 class="panel-title">Add/Edit Poem</h2>
                
                <form id="poem-form">
                    <div class="form-group">
                        <label for="poem-title">Poem Title</label>
                        <input type="text" id="poem-title" placeholder="Enter poem title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="poem-theme">Theme/Category</label>
                        <input type="text" id="poem-theme" placeholder="e.g., Love, Nature, Reflection">
                    </div>
                    
                    <div class="form-group">
                        <label for="poem-notes">Notes</label>
                        <textarea id="poem-notes" rows="4" placeholder="Add notes about this poem: inspiration, key lines, mood, etc."></textarea>
                    </div>
                    
                    <button type="submit" class="btn" id="save-btn">Save Poem</button>
                    <button type="button" class="btn btn-secondary" id="reset-btn">Reset Form</button>
                </form>
                
                <div class="poem-details" id="details-container">
                    <h3>Selected Poem Details</h3>
                    <div id="poem-details">
                        <div class="empty-state">
                            <i class="fas fa-file-alt"></i>
                            <p>Click on a poem node to view details here</p>
                        </div>
                    </div>
                </div>
                
                <div class="instructions">
                    <p><strong>How to use:</strong></p>
                    <p>1. Add poems using the form</p>
                    <p>2. Click on poem nodes to view details</p>
                    <p>3. Drag nodes to rearrange the mind map</p>
                    <p>4. Click and drag the background to pan</p>
                </div>
            </div>
        </div>

        <footer>
            <p>Poetry Notes Mind Map • Click and drag to navigate • Double-click to add a new node</p>
        </footer>
    </div>

    <script>
        // Initial poems data
        let poems = [
            { id: 1, title: "Whispers of Dawn", theme: "Nature", notes: "Written during sunrise at the beach. Focus on light imagery.", x: 300, y: 200 },
            { id: 2, title: "Echoes of You", theme: "Love", notes: "Inspired by a lost relationship. Uses repetition for emphasis.", x: 450, y: 120 },
            { id: 3, title: "Silent Conversations", theme: "Reflection", notes: "Explores internal dialogue and self-discovery.", x: 600, y: 200 },
            { id: 4, title: "Autumn's Lament", theme: "Seasons", notes: "Metaphor for change and letting go. Written in fall 2022.", x: 300, y: 350 },
            { id: 5, title: "Ocean's Embrace", theme: "Nature", notes: "Free verse about the sea's constant rhythm and comfort.", x: 150, y: 250 },
            { id: 6, title: "Unspoken Words", theme: "Love", notes: "About things left unsaid in relationships. Short, haiku-like stanzas.", x: 550, y: 350 }
        ];

        // DOM elements
        const mindmapEl = document.getElementById('mindmap');
        const poemForm = document.getElementById('poem-form');
        const poemTitleInput = document.getElementById('poem-title');
        const poemThemeInput = document.getElementById('poem-theme');
        const poemNotesInput = document.getElementById('poem-notes');
        const resetBtn = document.getElementById('reset-btn');
        const poemDetailsContainer = document.getElementById('poem-details');
        const saveBtn = document.getElementById('save-btn');
        
        // State variables
        let nextId = poems.length + 1;
        let selectedPoemId = null;
        let isDragging = false;
        let dragStartX, dragStartY;
        let offsetX = 0, offsetY = 0;
        let scale = 1;
        let isPanning = false;
        let panStartX, panStartY;
        
        // Initialize mind map
        function initMindMap() {
            // Clear mind map
            mindmapEl.innerHTML = '';
            
            // Set mind map dimensions
            mindmapEl.style.width = "2000px";
            mindmapEl.style.height = "1500px";
            mindmapEl.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
            mindmapEl.style.transformOrigin = "0 0";
            
            // Add center node
            const centerX = 1000;
            const centerY = 750;
            createNode('center', centerX, centerY, 'Poetry Collection', 'fas fa-book', 'node-center');
            
            // Add poem nodes
            poems.forEach(poem => {
                createPoemNode(poem);
            });
            
            // Draw connections from center to each poem
            poems.forEach(poem => {
                createConnection(centerX, centerY, poem.x, poem.y);
            });
            
            // Add event listeners for dragging and panning
            setupInteractivity();
            
            // If a poem is selected, highlight it
            if (selectedPoemId) {
                const selectedNode = document.getElementById(`poem-${selectedPoemId}`);
                if (selectedNode) {
                    selectedNode.classList.add('active');
                }
            }
        }
        
        // Create a poem node
        function createPoemNode(poem) {
            const node = document.createElement('div');
            node.id = `poem-${poem.id}`;
            node.className = 'node';
            node.style.left = `${poem.x}px`;
            node.style.top = `${poem.y}px`;
            node.dataset.id = poem.id;
            
            node.innerHTML = `
                <div class="node-title">${poem.title}</div>
                <div class="node-meta">${poem.theme || 'No theme'}</div>
                <div class="node-notes">${poem.notes || 'No notes yet'}</div>
            `;
            
            mindmapEl.appendChild(node);
            
            // Adjust position to account for node dimensions
            const nodeWidth = node.offsetWidth;
            const nodeHeight = node.offsetHeight;
            node.style.left = `${poem.x - nodeWidth/2}px`;
            node.style.top = `${poem.y - nodeHeight/2}px`;
            
            return node;
        }
        
        // Create a connection line
        function createConnection(x1, y1, x2, y2) {
            const connection = document.createElement('div');
            connection.className = 'connection';
            
            // Calculate distance and angle
            const dx = x2 - x1;
            const dy = y2 - y1;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            // Set connection styles
            connection.style.width = `${distance}px`;
            connection.style.left = `${x1}px`;
            connection.style.top = `${y1}px`;
            connection.style.transform = `rotate(${angle}deg)`;
            
            mindmapEl.appendChild(connection);
        }
        
        // Setup interactivity (dragging nodes, panning)
        function setupInteractivity() {
            const nodes = document.querySelectorAll('.node:not(.node-center)');
            
            // Node click event
            nodes.forEach(node => {
                node.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Remove active class from all nodes
                    document.querySelectorAll('.node').forEach(n => n.classList.remove('active'));
                    
                    // Add active class to clicked node
                    this.classList.add('active');
                    
                    // Get poem data
                    const poemId = parseInt(this.dataset.id);
                    selectedPoemId = poemId;
                    const poem = poems.find(p => p.id === poemId);
                    
                    if (poem) {
                        // Update form with poem data
                        poemTitleInput.value = poem.title;
                        poemThemeInput.value = poem.theme || '';
                        poemNotesInput.value = poem.notes || '';
                        
                        // Update details panel
                        updateDetailsPanel(poem);
                        
                        // Update button text
                        saveBtn.textContent = 'Update Poem';
                    }
                });
                
                // Node dragging
                let isDraggingNode = false;
                let startX, startY, initialLeft, initialTop;
                
                node.addEventListener('mousedown', function(e) {
                    e.stopPropagation();
                    isDraggingNode = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    
                    const rect = this.getBoundingClientRect();
                    initialLeft = parseFloat(this.style.left);
                    initialTop = parseFloat(this.style.top);
                    
                    // Bring to front
                    this.style.zIndex = '1000';
                    
                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                });
                
                function onMouseMove(e) {
                    if (!isDraggingNode) return;
                    
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    
                    node.style.left = `${initialLeft + dx}px`;
                    node.style.top = `${initialTop + dy}px`;
                    
                    // Update poem position in data
                    const poemId = parseInt(node.dataset.id);
                    const poem = poems.find(p => p.id === poemId);
                    if (poem) {
                        const nodeWidth = node.offsetWidth;
                        const nodeHeight = node.offsetHeight;
                        poem.x = initialLeft + dx + nodeWidth/2;
                        poem.y = initialTop + dy + nodeHeight/2;
                        
                        // Redraw connections
                        redrawConnections();
                    }
                }
                
                function onMouseUp() {
                    isDraggingNode = false;
                    node.style.zIndex = '10';
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }
            });
            
            // Center node click
            const centerNode = document.querySelector('.node-center');
            if (centerNode) {
                centerNode.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Remove active class from all nodes
                    document.querySelectorAll('.node').forEach(n => n.classList.remove('active'));
                    
                    // Add active class to center
                    this.classList.add('active');
                    
                    // Clear form
                    resetForm();
                    
                    // Update details panel
                    poemDetailsContainer.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-book"></i>
                            <p>Your poetry collection center</p>
                            <p style="margin-top: 10px; font-size: 0.9rem;">${poems.length} poems organized in the mind map</p>
                        </div>
                    `;
                    
                    // Update button text
                    saveBtn.textContent = 'Add Poem';
                    selectedPoemId = null;
                });
            }
            
            // Panning the mind map
            mindmapEl.addEventListener('mousedown', function(e) {
                if (e.target === mindmapEl) {
                    isPanning = true;
                    panStartX = e.clientX - offsetX;
                    panStartY = e.clientY - offsetY;
                    mindmapEl.style.cursor = 'grabbing';
                }
            });
            
            document.addEventListener('mousemove', function(e) {
                if (!isPanning) return;
                
                offsetX = e.clientX - panStartX;
                offsetY = e.clientY - panStartY;
                mindmapEl.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
            });
            
            document.addEventListener('mouseup', function() {
                isPanning = false;
                mindmapEl.style.cursor = 'default';
            });
            
            // Zoom with mouse wheel
            mindmapEl.addEventListener('wheel', function(e) {
                e.preventDefault();
                
                const zoomIntensity = 0.1;
                const oldScale = scale;
                
                // Determine zoom direction
                if (e.deltaY < 0) {
                    scale *= (1 + zoomIntensity);
                } else {
                    scale *= (1 - zoomIntensity);
                }
                
                // Limit zoom range
                scale = Math.min(Math.max(0.5, scale), 3);
                
                // Adjust offset to zoom toward cursor
                const rect = mindmapEl.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;
                
                offsetX = mouseX - (mouseX - offsetX) * (scale / oldScale);
                offsetY = mouseY - (mouseY - offsetY) * (scale / oldScale);
                
                mindmapEl.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
            });
        }
        
        // Redraw connections when nodes are moved
        function redrawConnections() {
            // Remove all connections
            const connections = document.querySelectorAll('.connection');
            connections.forEach(conn => conn.remove());
            
            // Get center position
            const centerNode = document.querySelector('.node-center');
            const centerRect = centerNode.getBoundingClientRect();
            const centerX = parseFloat(centerNode.style.left) + centerRect.width/2;
            const centerY = parseFloat(centerNode.style.top) + centerRect.height/2;
            
            // Redraw connections from center to each poem
            poems.forEach(poem => {
                createConnection(centerX, centerY, poem.x, poem.y);
            });
        }
        
        // Update details panel with poem info
        function updateDetailsPanel(poem) {
            poemDetailsContainer.innerHTML = `
                <div class="detail-item">
                    <div class="detail-label">Title</div>
                    <div class="detail-content">${poem.title}</div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-label">Theme/Category</div>
                    <div class="detail-content">${poem.theme || 'Not specified'}</div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-label">Notes</div>
                    <div class="detail-content">${poem.notes || 'No notes added yet'}</div>
                </div>
                
                <div class="detail-item">
                    <div class="detail-label">ID</div>
                    <div class="detail-content">${poem.id}</div>
                </div>
            `;
        }
        
        // Reset form
        function resetForm() {
            poemTitleInput.value = '';
            poemThemeInput.value = '';
            poemNotesInput.value = '';
            selectedPoemId = null;
            saveBtn.textContent = 'Add Poem';
            
            // Remove active class from all nodes
            document.querySelectorAll('.node').forEach(n => n.classList.remove('active'));
        }
        
        // Save/update poem
        poemForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = poemTitleInput.value.trim();
            const theme = poemThemeInput.value.trim();
            const notes = poemNotesInput.value.trim();
            
            if (!title) {
                alert('Please enter a poem title');
                return;
            }
            
            if (selectedPoemId) {
                // Update existing poem
                const poemIndex = poems.findIndex(p => p.id === selectedPoemId);
                if (poemIndex !== -1) {
                    poems[poemIndex].title = title;
                    poems[poemIndex].theme = theme;
                    poems[poemIndex].notes = notes;
                    
                    // Update the node
                    const node = document.getElementById(`poem-${selectedPoemId}`);
                    if (node) {
                        node.querySelector('.node-title').textContent = title;
                        node.querySelector('.node-meta').textContent = theme || 'No theme';
                        node.querySelector('.node-notes').textContent = notes || 'No notes yet';
                    }
                    
                    // Update details panel
                    updateDetailsPanel(poems[poemIndex]);
                    
                    alert('Poem updated successfully!');
                }
            } else {
                // Add new poem
                const newPoem = {
                    id: nextId++,
                    title,
                    theme,
                    notes,
                    x: 700 + (Math.random() * 200 - 100), // Random position near center
                    y: 500 + (Math.random() * 200 - 100)
                };
                
                poems.push(newPoem);
                
                // Create node
                createPoemNode(newPoem);
                
                // Redraw connections
                redrawConnections();
                
                // Reset form
                resetForm();
                
                // Select the new node
                setTimeout(() => {
                    const newNode = document.getElementById(`poem-${newPoem.id}`);
                    if (newNode) {
                        newNode.click();
                    }
                }, 100);
                
                alert('Poem added successfully!');
            }
        });
        
        // Reset button
        resetBtn.addEventListener('click', resetForm);
        
        // Double-click on mind map to add a new poem at that position
        mindmapEl.addEventListener('dblclick', function(e) {
            if (e.target === mindmapEl) {
                // Calculate position relative to mind map
                const rect = mindmapEl.getBoundingClientRect();
                const x = (e.clientX - rect.left - offsetX) / scale;
                const y = (e.clientY - rect.top - offsetY) / scale;
                
                // Prompt for poem title
                const title = prompt('Enter poem title:');
                if (title && title.trim()) {
                    const newPoem = {
                        id: nextId++,
                        title: title.trim(),
                        theme: '',
                        notes: '',
                        x: x,
                        y: y
                    };
                    
                    poems.push(newPoem);
                    
                    // Create node
                    createPoemNode(newPoem);
                    
                    // Redraw connections
                    redrawConnections();
                    
                    // Select the new node
                    setTimeout(() => {
                        const newNode = document.getElementById(`poem-${newPoem.id}`);
                        if (newNode) {
                            newNode.click();
                        }
                    }, 100);
                }
            }
        });
        
        // Initialize on page load
        window.addEventListener('load', initMindMap);
        
        // Handle window resize
        window.addEventListener('resize', function() {
            // In a real app, you might want to adjust node positions
            // For simplicity, we'll just reinitialize
            initMindMap();
        });
    </script>
</body>
</html>
